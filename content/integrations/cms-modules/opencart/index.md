# Платежный плагин RBKmoney для Opencart

- Модуль доступен для скачивания в нашем [открытом репозитории на GitHub](https://github.com/rbkmoney/rbkmoney-cms-opencart/releases/latest);
- Текущая стабильная версия модуля - 1.0;
- Совместимость:
	- Opencart 2.0;
	- Opencart 2.1;
	- Opencart 2.2.

!!!note
	В списке совместимости нет вашей версии Opencart 2.x? Напишите нам обращение [support@rbkmoney.com](mailto:support@rbkmoney.com).

## Установка и настройка модуля

### Первый способ

- Скачайте zip-файл с плагином из раздела [releases](https://github.com/rbkmoney/rbkmoney-cms-opencart/releases/latest);
- Зайдите в Extension Installer, нажмите Upload и выберите загруженный архив для установки.

### Второй способ

- распакуйте скачанный файл и скопируйте содержимое каталога upload

```
<OpenCart>/admin/
<OpenCart>/catalog/
```

## Настройка модуля

### В панели администратора

- Extensions > Payments > RBKmoney нажать [Install];
- Extensions > Payments > RBKmoney нажать [Edit] и заполнить необходимые настройки.

## Для начала приема платежей

- Настройте плагин в соответствии с данными из [личного кабинета RBKmoney](https://dashboard.rbk.money/);
- Сохраните изменения и проведите тестовый платеж.


## Список частых проблем и пути их решения

### Ошибка: FTP должен быть включен в настройках

- Если при установке модуля из админки отображается эта ошибка - вам нужно установить бесплатную FTP QuickFix модификацию localcopy.ocmod.xml. Она установится без проблем через тот же установщик дополнений, только после установки не забудьте обновить модификации и затем можете приступать к установке любых модулей на Opencart 2.
- Также решить эту ошибку можно по другому: прописать доступы к FTP в админке Система > Настройки > Магазин > вкладка FTP.

### Ошибка: Доступ запрещен!

- Если вы видите сообщение "Доступ запрещен! У Вас нет прав для доступа к этой странице. Если она Вам нужна, обратитесь к администратору." - нужно дать права администраторам на управление модулем или страницей.
- Решение: в админке Opencart 2 переходим в Система > Пользователи > Группы пользователей > Администраторы и здесь нажимаем "Выделить все" ниже обоих блоков, затем Сохранить.

### Ошибка: Недопустимый тип файла!

- Если модуль - это один XML файл, то его расширение должно быть .ocmod.xml
- Если модуль - это ocmod.zip архив, то его не нужно распаковывать, а устанавливать как есть. В таком архиве обязательно должна быть папка upload (может быть пустой), а также могут быть файлы модификаций: install.xml, install.php, install.sql. Никаких других файлов в корне архива быть не должно.

### Ошибка: Каталог, содержащий файлы для загрузки не может быть найден!

- Эта ошибка означает, что в загружаемом архиве отсутствует папка upload. Даже если у модуля нет файлов, кроме модификаций - эта папка должна присутствовать в архиве модуля .ocmod.zip, тогда она должна оставаться пустой.

### Ошибка: Модификатор использует тот же ID код который вы пытаетесь загрузить!

- Эта ошибка означает, что вы пытаетесь установить модификатор, который уже установлен или, возможно, у какого-то вашего модуля такой же ID.
- Для решения этой ошибки вам нужно перед установкой удалить старую версию модификации в разделе Модули > Модификации.
- Если такого модуля у вас нет, но совпадает ID, тогда нужно поменять значение параметра `<code>` в устанавливаемом модификаторе XML, сделать этот параметр уникальным дописав несколько символов.

### Ошибка: Warning: DOMDocument::loadXML(): CData section not finished

- Эта ошибка означает, что вы пытаетесь установить слишком объемный xml-модификатор.
- Количество символов в ocmod.xml файле не должно превышать 65535.
- Для решения ошибки нужно разбить xml-файл модификации на несколько частей, главное - не забыть задавать каждой уникальное значение в `<code>`, можно добавлять к текущему значению цифры 1,2,3... как идентификаторы части.

- Еще одним способом решения есть изменения типа в поля, где хранятся модификации, в таблице 'oc_modification' базы данных. Нужно выполнить следующий SQL-запрос:

```
ALTER TABLE oc_modification CHANGE xml MEDIUMTEXT CHARACTER SET utf8 COLLATE utf8_general_ci NOT NULL ;
```
